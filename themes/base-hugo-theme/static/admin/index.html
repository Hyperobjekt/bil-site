<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <title>Content Manager</title>
</head>
<body>
  <!-- Include the script that builds the page and powers Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@2.10.48/dist/netlify-cms.js"></script>
  <link rel="stylesheet" href="https://use.typekit.net/ayl0mep.css">
  <script>
    CMS.registerPreviewStyle("/css/cms.css");

    // Fancy blockquote
    CMS.registerEditorComponent({
      id: 'fancyBlockquote',
      label: 'Fancy Blockquote',
      fields: [
        {
          name: 'attrib',
          label: 'Attribution',
          widget: 'string',
          default: ' ',
          hint: 'Enter author name for quote attribution.'
        },
        {
          name: 'body',
          label: 'Quote',
          default: ' ',
          widget: 'markdown',
          hint: 'Enter the blockquote in Markdown format.'
        }
      ],
      pattern: /{{%[\s]+fancyblockquote[\s]+attrib="([\S\s]*?)"[\s]%}}([\S\s]*?){{%[\s]\/fancyblockquote[\s]%}}/,
      fromBlock: function (match) {
        return {
          attrib: match[1],
          body: match[2]
        };
      },
      toBlock: function (obj) {
        return '\n{{% fancyblockquote attrib="' + obj.attrib + '" %}}' + obj.body + '{{% /fancyblockquote %}}' + '\n';
      },
      toPreview: function (obj) {
        return '<blockquote class="fancy shortcode">' +
                 obj.body +
                 '<div class="quote-attrib">' + obj.attrib + '</div>' +
               '</blockquote>';
      }
    });

    // Full-width headshot and title
    CMS.registerEditorComponent({
      id: 'personBreaker',
      label: 'Person Breaker',
      fields: [
        {
          name: 'headshot',
          label: 'Image',
          widget: 'image',
          hint: 'Select the bio image for this person.'
        },
        {
          name: 'name',
          label: 'Name',
          default: ' ',
          widget: 'string',
          hint: 'Enter the name for this person.'
        },
        {
          name: 'title',
          label: 'Title',
          default: ' ',
          widget: 'string',
          hint: 'Enter the title for this person.'
        }
      ],
      pattern: /{{%[\s]+personbreaker[\s]+headshot="([\S\s]*?)"[\s]+name="([\S\s]*?)"[\s]+title="([\S\s]*?)"[\s]+%}}/,
      fromBlock: function (match) {
        return {
          headshot: match[1],
          name: match[2],
          title: match[3]
        };
      },
      toBlock: function (obj) {
        return '\n{{% personbreaker headshot="' + obj.headshot + '" name="' + obj.name + '" title="' + obj.title + '" %}}' + '\n';
      },
      toPreview: function (obj) {
        return '<div class="w-100 person-breaker shortcode">' +
            '<div class="headshot-wrapper">' +
              '<img class="update-headshot" src="' + obj.headshot + '" />' +
            '</div>' +
            '<div class="col-8 col-md-7 person-wrapper">' +
              '<div class="update-person-name">' + obj.name + '</div>' +
              '<div class="update-person-title">' + obj.title + '</div>' +
            '</div>' +
          '</div>';
      }
    });
  </script>
</body>
</html>
